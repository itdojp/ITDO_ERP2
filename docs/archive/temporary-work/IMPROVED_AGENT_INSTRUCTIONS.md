# 改良版エージェント指示文

## 現在の問題点
- 繰り返し実行が発生しない
- 活動報告が受け取れない形式
- 完了後の次タスク取得が不明確

## 改良版指示文（各エージェント用）

### CC01/CC02/CC03 共通指示文

```
以下の手順で継続的にタスクを実行してください：

1. 【初回報告】現在時刻と作業開始をGitHub Issue #351 にコメント投稿
   例: "CC01 作業開始: 2025-07-19 10:00 JST"

2. 【タスク選択】割り当てられたIssueから優先度順（P0→P1→P2→P3）で1つ選択
   - 選択したIssue番号をGitHub Issue #351 にコメント
   例: "作業開始: Issue #341 Task 1"

3. 【実行】選択したタスクを実行
   - コード変更はfeatureブランチで実施
   - テストを含めて完了させる

4. 【進捗報告】タスク完了時にGitHub Issue #351 に報告
   形式:
   ```
   完了: Issue #[番号] Task [番号]
   - 作業内容: [簡潔な説明]
   - コミット: [commit hash]
   - 所要時間: [分]
   - 次タスク: Issue #[番号] Task [番号]
   ```

5. 【問題報告】解決困難な場合は即座に報告
   ```
   ブロック: Issue #[番号] Task [番号]
   - 問題: [具体的な問題]
   - 試行内容: [試したこと]
   - 必要支援: [何が必要か]
   ```

6. 【継続実行】手順2に戻り、次のタスクを選択
   - 1日最低5タスクを目標
   - 8時間経過または20タスク完了で日次サマリーを投稿

7. 【日次サマリー】作業終了時にGitHub Issue #351 に投稿
   ```
   CC01 日次サマリー: 2025-07-19
   - 完了タスク: [数]
   - 完了Issue: #[番号], #[番号]
   - ブロック: [あれば記載]
   - 明日の予定: Issue #[番号]から継続
   ```

【重要】この手順を自動的に繰り返し、停止指示があるまで継続してください。
```

### エージェント別カスタマイズ

#### CC01（Frontend）追加指示
```
- コンポーネント作成時は必ずStorybookストーリーを含める
- アクセシビリティテストを実施
- パフォーマンス計測結果を報告に含める
```

#### CC02（Backend）追加指示
```
- API作成時は必ずOpenAPI仕様を更新
- 負荷テスト結果を報告に含める
- データベースマイグレーションは別PRで作成
```

#### CC03（Infrastructure）追加指示
```
- 変更前後でCI/CD実行時間を計測し報告
- セキュリティスキャン結果を含める
- 本番影響度を3段階（Low/Medium/High）で評価
```

## 活動報告の受信方法

### 1. GitHub Issue #351 での集約
- 全エージェントの活動をIssue #351のコメントで追跡
- タイムスタンプ付きで時系列確認可能
- GitHub通知で即座に把握

### 2. 日次レポートファイル（オプション）
各エージェントに以下のファイル作成を追加指示：
```
/reports/CC01_DAILY_$(date +%Y%m%d).md
/reports/CC02_DAILY_$(date +%Y%m%d).md
/reports/CC03_DAILY_$(date +%Y%m%d).md
```

### 3. コミットメッセージ規約
```
feat(cc01): [Issue #番号] タスク内容
fix(cc02): [Issue #番号] バグ修正内容
chore(cc03): [Issue #番号] インフラ変更内容
```

## 繰り返し実行を確実にする仕組み

### 1. 明示的なループ指示
```bash
# エージェント起動スクリプト例
while true; do
  # タスク選択
  TASK=$(select_next_task)
  
  # 実行
  execute_task $TASK
  
  # 報告
  report_progress $TASK
  
  # 5秒待機（API制限対策）
  sleep 5
done
```

### 2. タイムアウト設定
```
各タスクの最大実行時間: 2時間
2時間経過したら自動的に次のタスクへ移行
```

### 3. ヘルスチェック
```
30分ごとに生存報告をIssue #351に投稿
例: "CC01 稼働中: 2025-07-19 10:30 JST"
```

## 推奨される完全な指示文

```
GitHub Issue #351 を活動報告専用として使用し、以下の無限ループでタスクを実行してください：

while (true) {
  1. Issue #351 に現在時刻を投稿
  2. 優先度順で次のタスクを選択 
  3. タスク開始をIssue #351 に報告
  4. タスクを実行（最大2時間）
  5. 完了/ブロックをIssue #351 に詳細報告
  6. 5秒待機
  7. 手順2に戻る（自動的に繰り返し）
}

8時間経過または20タスク完了で日次サマリーを投稿。
30分ごとに生存報告を投稿。
停止指示があるまで永続的に継続。
```

この指示により、エージェントは自動的にタスクを繰り返し実行し、全ての活動がGitHub Issue #351で追跡可能になります。